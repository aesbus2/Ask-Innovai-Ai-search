<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Metro AI Call Center Analytics v6.0.0 - Production</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
    <link rel="stylesheet" href="/static/chatstyles.css" />
    <link rel="stylesheet" href="/static/transcript-search.css">
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>
                <span class="material-icons">analytics</span>
                Metro AI Call Center Analytics
                <span class="version-badge">v6.0.0 Production</span>
            </h1>
            <div class="header-controls">
                <button class="header-btn" onclick="toggleSidebar()">
                    <span class="material-icons">tune</span>
                    <span>Filters</span>
                </button>
                <button class="header-btn" onclick="exportChat()">
                    <span class="material-icons">download</span>
                    <span>Export</span>
                </button>
                <button class="header-btn" onclick="clearChat()">
                    <span class="material-icons">refresh</span>
                    <span>Clear</span>
                </button>
            </div>
        </div>

        <div class="main-layout">
            <!-- Sidebar -->
            <div class="sidebar" id="sidebar">
                <div class="sidebar-header">
                    <h3>Real-Time Analytics Filters</h3>
                    <p>All options loaded from live evaluation database</p>
                </div>

                <div class="filter-panel">
                    <!-- Date Filters -->
                    <div class="filter-section">
                        <h4>
                            <div class="section-title">
                                <span class="material-icons">date_range</span>
                                <span>Date Range</span>
                            </div>
                        </h4>
                        <div class="filter-content">
                            <div class="date-range">
                                <div class="date-input-group">
                                    <label>From:</label>
                                    <input type="date" id="startDate" onchange="updateFilters()">
                                </div>
                                <div class="date-input-group">
                                    <label>To:</label>
                                    <input type="date" id="endDate" onchange="updateFilters()">
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Partner Filter -->
                    <div class="filter-section">
                        <h4>
                            <div class="section-title">
                                <span class="material-icons">business</span>
                                <span>Partner</span>
                                <span class="loading-indicator" id="partnerLoading">‚è≥</span>
                            </div>
                        </h4>
                        <div class="filter-content">
                            <select id="partnerFilter" onchange="updateFilters()" class="filter-select">
                                <option value="">All Partners</option>
                            </select>
                        </div>
                    </div>

                    <!-- Site Filter -->
                    <div class="filter-section">
                        <h4>
                            <div class="section-title">
                                <span class="material-icons">location_on</span>
                                <span>Site</span>
                                <span class="loading-indicator" id="siteLoading">‚è≥</span>
                            </div>
                        </h4>
                        <div class="filter-content">
                            <select id="siteFilter" onchange="updateFilters()" class="filter-select">
                                <option value="">All Sites</option>
                            </select>
                        </div>
                    </div>

                    <!-- LOB Filter -->
                    <div class="filter-section">
                        <h4>
                            <div class="section-title">
                                <span class="material-icons">category</span>
                                <span>Line of Business</span>
                                <span class="loading-indicator" id="lobLoading">‚è≥</span>
                            </div>
                        </h4>
                        <div class="filter-content">
                            <select id="lobFilter" onchange="updateFilters()" class="filter-select">
                                <option value="">All LOBs</option>
                            </select>
                        </div>
                    </div>

                    <!-- Disposition Filter -->
                    <div class="filter-section">
                        <h4>
                            <div class="section-title">
                                <span class="material-icons">support</span>
                                <span>Disposition</span>
                                <span class="loading-indicator" id="dispositionLoading">‚è≥</span>
                            </div>
                        </h4>
                        <div class="filter-content">
                            <select id="dispositionFilter" onchange="updateFilters()" class="filter-select">
                                <option value="">All Dispositions</option>
                            </select>
                        </div>
                    </div>

                    <!-- Agent Filter -->
                    <div class="filter-section">
                        <h4>
                            <div class="section-title">
                                <span class="material-icons">person</span>
                                <span>Agent</span>
                                <span class="loading-indicator" id="agentLoading">‚è≥</span>
                            </div>
                        </h4>
                        <div class="filter-content">
                            <select id="agentFilter" onchange="updateFilters()" class="filter-select">
                                <option value="">All Agents</option>
                            </select>
                        </div>
                    </div>

                    <!-- Applied Filters Display -->
                    <div class="applied-filters" id="appliedFilters"></div>
                </div>
            </div>

            <!-- Main Chat Area -->
            <div class="chat-main">
                <!-- Chat Header with Applied Filters -->
                <div class="chat-header" id="chatHeader">
                    <div class="chat-title">
                        <span class="material-icons">chat</span>
                        AI Analytics Chat
                    </div>
                    <div class="chat-header-filters" id="headerFilterTags"></div>
                </div>

                <!-- Chat Messages -->
                <div class="chat-messages" id="chatMessages">
                    <div class="welcome-message">
                        <div class="message-content">
                            <div class="bot-header">
                                <div class="bot-avatar">
                                    <span class="material-icons">smart_toy</span>
                                </div>
                                <div class="bot-info">
                                    <strong>Metro AI Assistant</strong>
                                    <span class="bot-status">Production v5.1.0 ‚Ä¢ Connected</span>
                                </div>
                            </div>
                            <div class="welcome-text">
                                <h3>üéØ Welcome to Metro AI Call Center Analytics</h3>
                                <p><strong>Ask specific questions about your evaluation data:</strong></p>
                                <ul>
                                    <li>üìä <em>"Show me today's call performance by site"</em></li>
                                    <li>üîç <em>"Which agents have the highest customer satisfaction scores?"</em></li>
                                    <li>üìà <em>"What are the most common dispositions this week?"</em></li>
                                    <li>‚ö†Ô∏è <em>"Show me evaluations with quality issues"</em></li>
                                    <li>üéØ <em>"Compare this week's performance to last week"</em></li>
                                </ul>
                                <p><strong>üîß Use filters</strong> to focus on specific partners, sites, time periods, or agents.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Status Area -->
                <div class="status-area" id="statusArea" style="display: none;">
                    <div class="status-content">
                        <span class="status-icon">
                            <span class="material-icons">analytics</span>
                        </span>
                        <span class="status-text">Analyzing evaluation data...</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill"></div>
                    </div>
                </div>

                <!-- Quick Suggestions -->
                <div class="quick-suggestions" id="quickSuggestions">
                    <div style="
                        background: rgba(33, 150, 243, 0.05);
                        border: 1px solid rgba(33, 150, 243, 0.2);
                        border-radius: 8px;
                        color: #1976d2;
                        padding: 2px 8px;
                        border-radius: 12px;
                        font-size: 0.75rem;
                        font-weight: 500;
                    ">
                        All Content
                    </div>
                </div>

                <!-- Chat Input -->
                <div class="chat-input-area">
                    <!-- SIMPLE: Minimal comprehensive toggle -->
                    <div style="margin-bottom: 8px;">
                        <label style="display: flex; align-items: center; gap: 6px; font-size: 0.85rem; cursor: pointer; color: #666;">
                            <input type="checkbox" id="comprehensiveToggle" onchange="updateComprehensiveMode()" style="margin: 0;">
                            <span>üîç Comprehensive Search</span>
                            <span id="searchModeDescription" style="font-size: 0.8rem; color: #999; font-style: italic;">(Smart detection)</span>
                        </label>
                    </div>
                    
                    <div class="input-container">
                        <textarea id="chatInput" class="chat-input"
                            placeholder="Ask specific questions about calls, dispositions, site performance, quality metrics, or any evaluation data from your live database..."
                            rows="1" onkeydown="handleKeyPress(event)"></textarea>
                        <button class="send-btn" id="sendBtn" onclick="sendMessage()">
                            <span class="material-icons">analytics</span>
                            Analyze
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
    // Production initialization - KEEP ONLY THIS
    document.addEventListener('DOMContentLoaded', function () {
        console.log("üöÄ Production Chat Interface v6.0.0 initializing...");

        // Initialize comprehensive mode
        window.comprehensiveMode = false;
        updateComprehensiveMode();
    });
    </script>

    <script src="/static/chat.js"></script>
</body>
</html>
