<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Metro AI Call Center Analytics v6.0.0 - Production</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
    <link rel="stylesheet" href="/static/chatstyles.css" />
    <link rel="stylesheet" href="/static/transcript-search.css">
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>
                <span class="material-icons">analytics</span>
                InnovAI Call Center Analytics                
            </h1>
            <div class="header-controls">
                <button class="header-btn" onclick="exportChat()">
                    <span class="material-icons">download</span>
                    <span>Export</span>
                </button>
                <button class="header-btn" onclick="clearChat()">
                    <span class="material-icons">refresh</span>
                    <span>Clear</span>
                </button>
            </div>
        </div>

        <div class="main-layout">
            <!-- Filter Toggle Tab - Smaller and moves with panel -->
            <div class="sidebar-tab" onclick="toggleSidebar()" id="sidebarTab">
                <span class="material-icons">menu_open</span>
                <span class="tab-text">FILTERS</span>
            </div>

            <!-- Apply Filters Tab - Applies filters and closes sidebar -->
            <div class="apply-tab" onclick="applyFiltersAndClose()" id="applyTab">
                <span class="material-icons">check</span>
                <span class="tab-text">APPLY</span>
            </div>

            <!-- Cancel Filters Tab - Closes sidebar without applying -->
            <div class="cancel-tab" onclick="cancelFilters()" id="cancelTab">
                <span class="material-icons">close</span>
                <span class="tab-text">CLEAR</span>
            </div>

            <!-- Sidebar -->
            <div class="sidebar" id="sidebar">
                <div class="sidebar-header">
                    <h3>Real-Time Analytics Filters</h3>
                    <p>All options loaded from live evaluation database</p>
                </div>

                <div class="filter-panel">
                    <!-- Date Filters -->
                    <div class="filter-section">
                        <h4>
                            <div class="section-title">
                                <span class="material-icons">date_range</span>
                                Date & Time Filters
                            </div>
                        </h4>
                        <div class="filter-content">
                            <div class="filter-group">
                                <label class="filter-label">Call Date Range</label>
                                <div class="date-range">
                                    <input type="date" id="startCallDate" class="filter-input" title="Start Date">
                                    <input type="date" id="endCallDate" class="filter-input" title="End Date">
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Organizational Hierarchy -->
                    <div class="filter-section">
                        <h4>
                            <div class="section-title">
                                <span class="material-icons">account_tree</span>
                                Organizational Hierarchy
                            </div>
                            <span id="hierarchyDataStatus" class="data-status data-status-ok">
                                ‚úÖ Ready
                            </span>
                        </h4>
                        <div class="filter-content">
                            <div class="hierarchy-note">
                                <strong>REAL DATA Filters:</strong> Template (evaluation form) ‚Üí Program (business
                                unit) ‚Üí Partner ‚Üí Site ‚Üí LOB
                                <br><small>All options loaded from your actual evaluation database</small>
                            </div>

                            <div class="filter-group">
                                <label class="filter-label">
                                    Template (Evaluation Form)
                                    <span id="templateCount" class="count-indicator"></span>
                                </label>
                                <select id="templateFilter" class="filter-select"
                                    onchange="updateHierarchyFilters('template')">
                                    <option value="">All Templates</option>
                                </select>
                                <small class="filter-help">
                                    InnovAi QA evaluation templates
                                </small>
                            </div>

                            <div class="filter-group">
                                <label class="filter-label">
                                    Program (Business Unit)
                                    <span id="programCount" class="count-indicator"></span>
                                </label>
                                <select id="programFilter" class="filter-select"
                                    onchange="updateHierarchyFilters('program')">
                                    <option value="">All Programs</option>
                                </select>
                                <small class="filter-help">
                                   Metro, ASW, T-Mobile Prepaid
                                </small>
                            </div>

                            <div class="filter-group">
                                <label class="filter-label">
                                    Partner (Vendor)
                                    <span id="partnerCount" class="count-indicator"></span>
                                </label>
                                <select id="partnerFilter" class="filter-select"
                                    onchange="updateHierarchyFilters('partner')">
                                    <option value="">All Partners</option>
                                </select>
                                <small class="filter-help">
                                    Call center vendors
                                </small>
                            </div>

                            <div class="filter-group">
                                <label class="filter-label">
                                    Site (Location)
                                    <span id="siteCount" class="count-indicator"></span>
                                </label>
                                <select id="siteFilter" class="filter-select" onchange="updateHierarchyFilters('site')">
                                    <option value="">All Sites</option>
                                </select>
                                <small class="filter-help">
                                    where the site is located
                                </small>
                            </div>

                            <div class="filter-group">
                                <label class="filter-label">
                                    Line of Business (LOB)
                                    <span id="lobCount" class="count-indicator"></span>
                                </label>
                                <select id="lobFilter" class="filter-select">
                                    <option value="">All LOBs</option>
                                </select>
                                <small class="filter-help">
                                    CSR, DSG, WNP, Specialty, etc.
                                </small>
                            </div>
                        </div>
                    </div>

                    <!-- Call Identifiers -->
                    <div class="filter-section">
                        <h4>
                            <div class="section-title">
                                <span class="material-icons">fingerprint</span>
                                Call Identifiers
                            </div>
                        </h4>
                        <div class="filter-content">
                            <div class="filter-group">
                                <label class="filter-label">Evaluation ID</label>
                                <input type="text" id="evaluationIdFilter" class="filter-input"
                                    placeholder="e.g., EVAL-12345-2024" maxlength="50">
                            </div>

                            <div class="filter-group">
                                <label class="filter-label">Phone Number</label>
                                <input type="text" id="phoneNumberFilter" class="filter-input"
                                    placeholder="e.g., 3094399902" maxlength="15">
                            </div>

                            <div class="filter-group">
                                <label class="filter-label">Contact ID</label>
                                <input type="text" id="contactIdFilter" class="filter-input"
                                    placeholder="e.g., 3014818427" maxlength="20">
                            </div>

                            <div class="filter-group">
                                <label class="filter-label">Transaction ID (UCID)/label>
                                <input type="text" id="ucidFilter" class="filter-input"
                                    placeholder="e.g., 000011103817514224423" maxlength="30">
                            </div>
                        </div>
                    </div>

                    <!-- Call Classification -->
                    <div class="filter-section">
                        <h4>
                            <div class="section-title">
                                <span class="material-icons">call</span>
                                Call Classification
                            </div>
                            <span id="callDataStatus" class="data-status data-status-ok">
                                ‚úÖ Ready
                            </span>
                        </h4>
                        <div class="filter-content">
                            <div class="filter-group">
                                <label class="filter-label">
                                    Call Disposition
                                    <span id="dispositionCount" class="count-indicator"></span>
                                </label>
                                <select id="callDispositionFilter" class="filter-select"
                                    onchange="updateSubDispositions()">
                                    <option value="">All Dispositions</option>
                                </select>
                                <small class="filter-help">
                                    Main interaction reason
                                </small>
                            </div>

                            <div class="filter-group">
                                <label class="filter-label">
                                    Call Sub-Disposition
                                    <span id="subDispositionCount" class="count-indicator"></span>
                                </label>
                                <select id="callSubDispositionFilter" class="filter-select">
                                    <option value="">All Sub-Dispositions</option>
                                </select>
                                <small class="filter-help">
                                    Detailed reason for the interaction
                                </small>
                            </div>

                            <div class="filter-group">
                                <label class="filter-label">
                                    Call Language
                                    <span id="languageCount" class="count-indicator"></span>
                                </label>
                                <select id="languageFilter" class="filter-select">
                                    <option value="">All Languages</option>
                                </select>
                            </div>

                            <div class="filter-group">
                                <label class="filter-label">
                                    Call Type
                                    <span id="callTypeCount" class="count-indicator"></span>
                                </label>
                                <select id="callTypeFilter" class="filter-select">
                                    <option value="">All Call Types</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="filter-actions">
                        <button class="clear-btn" onclick="clearFilters()">
                            <span class="material-icons">clear</span>
                            Clear All
                        </button>
                    </div>
                </div>
            </div>

            <!-- Chat Area -->
            <div class="chat-area">
                <div class="chat-header">
                    <div class="chat-header-top">
                        <div>
                            <div class="chat-title">Call Center Analytics Dashboard</div>
                            <div class="chat-subtitle">AI-powered insights from real evaluation data</div>
                        </div>
                        <div class="chat-stats">
                            <div class="stat-item">
                                <span class="material-icons">dataset</span>
                                <span id="totalRecords">Ready for analysis</span>
                            </div>
                            <div class="stat-item">
                                <span class="material-icons">filter_alt</span>
                                <span id="activeFiltersCount">0 filters</span>
                            </div>
                        </div>
                    </div>

                    <!-- Header Filter Display -->
                    <div class="chat-header-filters" id="chatHeaderFilters">
                        <!-- Filter tags will be populated here -->
                    </div>
                </div>

                <div class="messages-container" id="messagesContainer">
                    <!-- Welcome Screen -->
                    <div class="welcome-screen" id="welcomeScreen">
                        <div class="welcome-icon">üìû</div>
                        <h2 class="welcome-title">InnovAi Call Center Analytics</h2>
                        <p class="welcome-subtitle">
                            Ask InnovAI to analyze call dispositions, agent performance, site comparisons, and more from
                            your live evaluation database...
                        </p>

                        <div class="example-questions">
                            <div class="example-card"
                                onclick="askQuestion('Create a concise weekly call quality analysis from audit data. Summarize Strengths, Weaknesses, and Opportunities with a clear bottom-line insight for each. Include key metrics (percentages, counts, week-over-week changes), site performance highlights, root-cause trends, and agent-controllable vs non-controllable factors. Use a professional, leadership-ready tone and clearly identify critical risks, performance gains, and priority coaching focus areas.')">
                                <h4>Executive Summary Report</h4>
                                <p>Analyze customer service metrics and agent performance trends</p>
                            </div>
                            <div class="example-card"
                                onclick="askQuestion('Review customer service transcripts and generate a CSAT analysis. Identify satisfaction drivers, friction points, empathy and closing gaps, repeat-contact signals, and resolution quality. Summarize what‚Äôs working, what‚Äôs hurting CSAT, and priority coaching actions in a leadership-ready tone.')">
                                <h4>Customer Satisfaction</h4>
                                <p>General Customer Satisfaction (CSAT) Analysis</p>
                            </div>
                            <div class="example-card"
                                onclick="askQuestion('Review transcripts for churn risk signals (dissatisfaction, cancel intent, carrier switching). Classify risk level, key drivers, mitigation success, and agent-controllable gaps. Output a concise churn risk summary and intervention priorities. ‚ÄúOutput sections: Churn Risk Summary, Risk Levels, Key Drivers, Mitigated vs Unmitigated, Coaching or Save Opportunities.')">
                                <h4>Identify Churn Risk</h4>
                                <p>Churn Risk Summary, Risk Levels, Key Drivers, Mitigated vs Unmitigated, Coaching or Save Opportunities.
                                    enhancement</p>
                            </div>
                            <div class="example-card"
                                onclick="askQuestion('Generate a weekly retention performance analysis from audit data. Summarize what iss working, what is broken, and key opportunities across the retention funnel (attempts, offers, saves). Include save rate, attempt rate, red flags, week-over-week changes, site performance, rejection reasons, and agent-controllable vs non-controllable failures. Highlight risks where fundamentals decline despite strong results, and identify priority coaching actions in a leadership-ready, data-driven tone.')">
                                <h4>Retention Report</h4>
                                <p>Retention performance analysis from audit data. Summarize what is working, what iss broken, and key opportunities.
                                    <span class="card-more-indicator">‚Ä¢ Click for detailed criteria</span>
                                </p>
                            </div>
                           </div>
                    </div>

                    <!-- Chat Messages -->
                    <div id="chatMessages" class="hidden">
                        <!-- Chat sessions will be populated here -->
                    </div>
                </div>

                <!-- Quick Questions -->
                <div class="quick-questions" id="quickQuestions">
                    <h4>üí° Quick Analytics Questions</h4>
                    <div class="question-buttons">
                        <button class="question-btn"
                            onclick="askQuestion('Create a concise weekly call quality analysis from audit data. Summarize Strengths, Weaknesses, and Opportunities with a clear bottom-line insight for each. Include key metrics (percentages, counts, week-over-week changes), site performance highlights, root-cause trends, and agent-controllable vs non-controllable factors. Use a professional, leadership-ready tone and clearly identify critical risks, performance gains, and priority coaching focus areas.')">
                            Executive Summary
                        </button>
                        <button class="question-btn"
                            onclick="askQuestion('Show me the longest calls with their outcomes and patterns, and the call type')">
                            Long Calls
                        </button>
                        <button class="question-btn"
                            onclick="askQuestion('Show me all the calls where the agent made a sales offer or account upgrade')">
                            Sales opportunities
                        </button>
                        <button class="question-btn"
                            onclick="askQuestion('Review this Metro by T-Mobile customer service transcript and identify any behaviors, statements, or process breakdowns that could negatively impact JD Power rankings or overall customer satisfaction, focusing on empathy, professionalism, tone, clarity and accuracy, first-contact resolution, hold or transfer handling, ownership of the issue, policy explanations, and how the call is recapped and closed. Provide the impact category, why it could lower JD Power scores, the severity level (Low, Medium, or High), the likely root cause (agent skill, training gap, policy limitation, or system/process issue), and a brief coaching opportunity; if no significant risks are present, clearly state that none were detected.')">
                            JDP Focus
                        </button>
                        </div>
                </div>

                <!-- Chat Input -->
                <div class="chat-input-area">
                    <!-- Comprehensive Search Toggle - Minimal -->
                    <div style="margin-bottom: 8px; font-size: 0.85rem;">
                        <label style="display: flex; align-items: center; gap: 6px; cursor: pointer; color: #666;">
                            <input type="checkbox" id="comprehensiveToggle" onchange="updateComprehensiveMode()" style="margin: 0;">
                            <span>üîç Comprehensive Search</span>
                            <span id="searchModeDescription" style="font-size: 0.8rem; color: #999; font-style: italic;">(Smart detection)</span>
                        </label>
                    </div>
                    
                    <div class="input-container">
                        <textarea id="chatInput" class="chat-input"
                            placeholder="Ask specific questions about calls, dispositions, site performance, quality metrics, or any evaluation data from your live database..."
                            rows="1" onkeydown="handleKeyPress(event)"></textarea>                        
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
    // Sidebar toggle functionality - integrates with existing chat.js
    function toggleSidebar() {
        const sidebar = document.getElementById('sidebar');
        const tab = document.getElementById('sidebarTab');
        
        if (!sidebar) {
            console.error('Sidebar element not found');
            return;
        }
        
        const isOpen = sidebar.classList.contains('open');
        
        if (isOpen) {
            // Close sidebar
            sidebar.classList.remove('open');
            if (tab) tab.classList.remove('active');
            removeBackdrop();
            console.log('Sidebar toggled: CLOSED');
        } else {
            // Open sidebar
            sidebar.classList.add('open');
            if (tab) tab.classList.add('active');
            createBackdrop();
            console.log('Sidebar toggled: OPEN');
        }
    }
    
    // Apply filters and close sidebar automatically
    function applyFiltersAndClose() {
        console.log('üîÑ Apply filters and close sidebar...');
        
        // First apply the filters (this function comes from chat.js)
        if (typeof window.applyFilters === 'function') {
            window.applyFilters();
        } else {
            console.warn('‚ö†Ô∏è applyFilters function not yet loaded');
        }
        
        // Then close the sidebar
        const sidebar = document.getElementById('sidebar');
        const tab = document.getElementById('sidebarTab');
        
        if (sidebar && sidebar.classList.contains('open')) {
            sidebar.classList.remove('open');
            if (tab) tab.classList.remove('active');
            removeBackdrop();
            console.log('‚úÖ Filters applied and sidebar closed');
        }
    }
    
    // Cancel filters and close sidebar without applying changes
    function cancelFilters() {
        console.log('‚ùå Cancel filters - closing sidebar without applying changes...');
        
        // Close the sidebar without applying changes
        const sidebar = document.getElementById('sidebar');
        const tab = document.getElementById('sidebarTab');
        
        if (sidebar && sidebar.classList.contains('open')) {
            sidebar.classList.remove('open');
            if (tab) tab.classList.remove('active');
            removeBackdrop();
            console.log('‚úÖ Sidebar closed without applying changes');
        }
        
        // Optional: Reset form to previous state
        // (You can add logic here to reset filter form if needed)
    }
    
    // SIMPLE manual filter enhancement - NO automatic monitoring
    function enhanceFilterDisplay() {
        const activeFiltersElement = document.getElementById('activeFiltersCount');
        const totalRecordsElement = document.getElementById('totalRecords');
        
        if (!activeFiltersElement || !totalRecordsElement) {
            console.log('‚ùå Elements not found');
            return false;
        }
        
        const totalText = totalRecordsElement.textContent || '';
        const filterText = activeFiltersElement.textContent || '';
        
        console.log('üìä Current display values:', { totalText, filterText });
        
        // Only enhance if it's basic format and not already enhanced
        if (filterText.match(/^\d+ filters?$/) && !filterText.includes('results') && !filterText.includes('total')) {
            const totalMatch = totalText.match(/([0-9,]+)/);
            const filterMatch = filterText.match(/^(\d+)/);
            
            if (totalMatch && filterMatch) {
                const totalCount = totalMatch[1];
                const filterCount = parseInt(filterMatch[1]);
                
                let enhancedText;
                if (filterCount > 0) {
                    enhancedText = `${filterCount} filter${filterCount !== 1 ? 's' : ''} (${totalCount} results)`;
                } else {
                    enhancedText = `0 filters (${totalCount} total)`;
                }
                
                activeFiltersElement.textContent = enhancedText;
                console.log(`‚úÖ Enhanced: "${filterText}" ‚Üí "${enhancedText}"`);
                return true;
            }
        } else {
            console.log('üìä Display already enhanced or no data available');
            return false;
        }
    }
    
    // Monitor for changes to the analytics display and enhance them
    function monitorAnalyticsUpdates() {
        const totalRecordsElement = document.getElementById('totalRecords');
        const activeFiltersCountElement = document.getElementById('activeFiltersCount');
        
        if (!totalRecordsElement || !activeFiltersCountElement) {
            console.error('‚ùå Cannot monitor - required elements not found');
            return;
        }
        
        // Create observer for both elements
        const observer = new MutationObserver(function(mutations) {
            let shouldEnhance = false;
            
            mutations.forEach(function(mutation) {
                if (mutation.type === 'childList' || mutation.type === 'characterData') {
                    console.log('üîÑ Analytics update detected on:', mutation.target.id || mutation.target.className);
                    shouldEnhance = true;
                }
            });
            
            if (shouldEnhance) {
                // Multiple timeouts to catch different update patterns
                setTimeout(() => enhanceFilterCountDisplay(), 50);
                setTimeout(() => enhanceFilterCountDisplay(), 200);
                setTimeout(() => enhanceFilterCountDisplay(), 500);
            }
        });
        
        // Observe both elements
        const observeConfig = {
            childList: true,
            subtree: true,
            characterData: true,
            attributes: false
        };
        
        observer.observe(totalRecordsElement, observeConfig);
        observer.observe(activeFiltersCountElement, observeConfig);
        
        // Also set up periodic enhancement (fallback)
        setInterval(() => {
            const current = activeFiltersCountElement.textContent || '';
            if (current.includes('filters') && !current.includes('results') && !current.includes('total')) {
                console.log('üîÑ Periodic enhancement check - needs update');
                enhanceFilterCountDisplay();
            }
        }, 3000);
        
        console.log('üìä Advanced analytics display monitor activated');
    }
    
    // Create backdrop overlay
    function createBackdrop() {
        removeBackdrop(); // Remove existing first
        
        const backdrop = document.createElement('div');
        backdrop.className = 'sidebar-backdrop';
        backdrop.id = 'sidebarBackdrop';
        backdrop.addEventListener('click', closeSidebar);
        
        document.body.appendChild(backdrop);
        
        setTimeout(() => {
            backdrop.classList.add('show');
        }, 10);
    }
    
    // Remove backdrop overlay
    function removeBackdrop() {
        const backdrop = document.getElementById('sidebarBackdrop');
        if (backdrop) {
            backdrop.classList.remove('show');
            setTimeout(() => backdrop.remove(), 300);
        }
    }
    
    // Close sidebar (used by backdrop click)
    function closeSidebar() {
        const sidebar = document.getElementById('sidebar');
        const tab = document.getElementById('sidebarTab');
        
        if (sidebar && sidebar.classList.contains('open')) {
            sidebar.classList.remove('open');
            if (tab) tab.classList.remove('active');
            removeBackdrop();
            console.log('Sidebar closed via backdrop');
        }
    }
    
    // Initialize sidebar state when page loads
    document.addEventListener('DOMContentLoaded', function () {
        console.log("üéõÔ∏è Sidebar integration initializing...");
        
        // Initialize sidebar as closed
        const sidebar = document.getElementById('sidebar');
        const tab = document.getElementById('sidebarTab');
        
        if (sidebar) {
            sidebar.classList.remove('open');
            console.log('‚úÖ Sidebar initialized: CLOSED');
        }
        
        if (tab) {
            tab.classList.remove('active');
            console.log('‚úÖ Sidebar tab initialized: INACTIVE');
        }
        
        // Initialize apply tab
        const applyTab = document.getElementById('applyTab');
        if (applyTab) {
            console.log('‚úÖ Apply tab initialized');
            // Apply tab doesn't have active states, it's action-based
        }
        
        // Initialize cancel tab
        const cancelTab = document.getElementById('cancelTab');
        if (cancelTab) {
            console.log('‚úÖ Cancel tab initialized');
            // Cancel tab doesn't have active states, it's action-based
        }
        
        removeBackdrop(); // Clean up any existing backdrop
        
        // Ensure applyFilters function is available
        if (typeof window.applyFilters !== 'function') {
            console.warn('‚ö†Ô∏è applyFilters function not yet loaded, will be available when chat.js loads');
        }
        
        // NO automatic monitoring - manual enhancement only
        console.log('üìä Filter enhancement available via manual functions only');
        console.log('üí° Use enhanceNow() or testEnhancedDisplay() to enhance filter display');
        
        // Note: No automatic monitoring to prevent loops
        
        // Note: Analytics stats are handled by the main chat.js file
        console.log('üìä Filter counts will be enhanced to show results by monitor system');
    });
    
    // MANUAL ONLY debug functions - no automatic monitoring
    window.testEnhancedDisplay = function() {
        console.log('üß™ Manual enhancement test...');
        const result = enhanceFilterDisplay();
        console.log('üß™ Enhancement result:', result);
    };
    
    window.enhanceNow = function() {
        console.log('üîß Manual enhancement triggered...');
        return enhanceFilterDisplay();
    };
    
    window.checkFilterDisplay = function() {
        const activeElement = document.getElementById('activeFiltersCount');
        const totalElement = document.getElementById('totalRecords');
        
        console.log('üîç Current display state:');
        console.log('  activeFiltersCount:', activeElement ? `"${activeElement.textContent}"` : 'NOT FOUND');
        console.log('  totalRecords:', totalElement ? `"${totalElement.textContent}"` : 'NOT FOUND');
        
        return {
            activeFilters: activeElement ? activeElement.textContent : null,
            totalRecords: totalElement ? totalElement.textContent : null
        };
    };
    
    // Manual enhancement function
    window.enhanceNow = function() {
        console.log(`üß™ Setting basic display: ${filterCount} filters with ${resultCount} results`);
        
        const activeElement = document.getElementById('activeFiltersCount');
        const totalElement = document.getElementById('totalRecords');
        
        if (totalElement) {
            totalElement.textContent = `${resultCount.toLocaleString()} evaluations`;
        }
        if (activeElement) {
            // Set basic format that can be manually enhanced
            activeElement.textContent = `${filterCount} filter${filterCount !== 1 ? 's' : ''}`;
        }
        
        console.log('üí° Now call enhanceNow() to enhance the display');
        
        return {
            activeFilters: activeElement ? activeElement.textContent : null,
            totalRecords: totalElement ? totalElement.textContent : null
        };
    };
    
    // Force enhancement function reference
    window.forceEnhanceDisplay = forceUpdateFilterDisplay;
    
    window.testInterceptor = function() {
        const activeElement = document.getElementById('activeFiltersCount');
        if (activeElement) {
            console.log('üß™ Testing interceptor by setting "2 filters"...');
            activeElement.textContent = '2 filters';
        }
    };
    
    // Test function to manually set visible content and verify elements exist
    window.testElementsVisibility = function() {
        console.log('üß™ Testing element visibility...');
        
        const totalElement = document.getElementById('totalRecords');
        const activeElement = document.getElementById('activeFiltersCount');
        
        if (totalElement) {
            totalElement.textContent = 'TEST: 9,999 evaluations';
            totalElement.style.color = 'red';
            totalElement.style.fontSize = '16px';
            totalElement.style.fontWeight = 'bold';
            console.log('‚úÖ totalRecords element found and updated');
        } else {
            console.error('‚ùå totalRecords element NOT FOUND');
        }
        
        if (activeElement) {
            activeElement.textContent = 'TEST: 5 filters';
            activeElement.style.color = 'red';
            activeElement.style.fontSize = '16px';
            activeElement.style.fontWeight = 'bold';
            console.log('‚úÖ activeFiltersCount element found and updated');
        } else {
            console.error('‚ùå activeFiltersCount element NOT FOUND');
        }
        
        // Also test the parent containers
        const chatStats = document.querySelector('.chat-stats');
        if (chatStats) {
            console.log('‚úÖ .chat-stats container found');
            console.log('Chat stats display style:', window.getComputedStyle(chatStats).display);
            console.log('Chat stats visibility:', window.getComputedStyle(chatStats).visibility);
            console.log('Chat stats dimensions:', {
                width: chatStats.offsetWidth,
                height: chatStats.offsetHeight,
                top: chatStats.offsetTop,
                left: chatStats.offsetLeft
            });
        } else {
            console.error('‚ùå .chat-stats container NOT FOUND');
        }
        
        const chatHeader = document.querySelector('.chat-header');
        if (chatHeader) {
            console.log('‚úÖ .chat-header container found');
            console.log('Chat header dimensions:', {
                width: chatHeader.offsetWidth,
                height: chatHeader.offsetHeight,
                top: chatHeader.offsetTop,
                left: chatHeader.offsetLeft
            });
        } else {
            console.error('‚ùå .chat-header container NOT FOUND');
        }
    };
    
    // Fallback applyFilters function (will be replaced by chat.js when it loads)
    if (typeof window.applyFilters !== 'function') {
        window.applyFilters = function() {
            console.log('üîÑ Apply filters called (fallback) - waiting for chat.js to load...');
            // The real applyFilters will be available once chat.js loads
            if (window.applyFilters && window.applyFilters !== arguments.callee) {
                window.applyFilters();
            }
        };
    }
    
    // Debug function to test tabs
    window.testTabs = function() {
        console.log('üß™ Testing tab functionality...');
        const sidebar = document.getElementById('sidebar');
        const sidebarTab = document.getElementById('sidebarTab');
        const applyTab = document.getElementById('applyTab');
        const cancelTab = document.getElementById('cancelTab');
        
        console.log('Elements found:', {
            sidebar: !!sidebar,
            sidebarTab: !!sidebarTab, 
            applyTab: !!applyTab,
            cancelTab: !!cancelTab
        });
        
        if (sidebar) {
            console.log('Sidebar classes:', sidebar.className);
        }
    };
    </script>

    <script src="/static/chat.js"></script>
</body>

</html>